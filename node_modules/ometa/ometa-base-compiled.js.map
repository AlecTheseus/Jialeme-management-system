{"version":3,"sources":["ometa-base.js"],"names":[],"mappings":"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","file":"ometa-base-compiled.js","sourcesContent":["/*\n  Copyright (c) 2007-2010 Alessandro Warth <awarth@cs.ucla.edu>\n\n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation\n  files (the \"Software\"), to deal in the Software without\n  restriction, including without limitation the rights to use,\n  copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the\n  Software is furnished to do so, subject to the following\n  conditions:\n\n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n  HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n  OTHER DEALINGS IN THE SOFTWARE.\n*/\n\n/*\n  new syntax:\n    #foo and `foo\tmatch the string object 'foo' (it's also accepted in my JS)\n    'abc'\t\tmatch the string object 'abc'\n    'c'\t\t\tmatch the string object 'c'\n    ``abc''\t\tmatch the sequence of string objects 'a', 'b', 'c'\n    \"abc\"\t\ttoken('abc')\n    [1 2 3]\t\tmatch the array object [1, 2, 3]\n    foo(bar)\t\tapply rule foo with argument bar\n    -> ...\t\tsemantic actions written in JS (see OMetaParser's atomicHostExpr rule)\n*/\n\n/*\nometa M {\n  number = number:n digit:d -> { n * 10 + d.digitValue() }\n         | digit:d          -> { d.digitValue() }\n}\n\ntranslates to...\n\nM = objectThatDelegatesTo(OMeta, {\n  number: function() {\n            return this._or(function() {\n                              var n = this._apply(\"number\"),\n                                  d = this._apply(\"digit\")\n                              return n * 10 + d.digitValue()\n                            },\n                            function() {\n                              var d = this._apply(\"digit\")\n                              return d.digitValue()\n                            }\n                           )\n          }\n})\nM.matchAll(\"123456789\", \"number\")\n*/\n\n// the failure exception\n\nfail = { toString: function() { return \"match failed\" } }\n\n// streams and memoization\n\nfunction OMInputStream(hd, tl) {\n  this.memo = { }\n  this.lst  = tl.lst\n  this.idx  = tl.idx\n  this.hd   = hd\n  this.tl   = tl\n}\nOMInputStream.prototype.head = function() { return this.hd }\nOMInputStream.prototype.tail = function() { return this.tl }\nOMInputStream.prototype.type = function() { return this.lst.constructor }\nOMInputStream.prototype.upTo = function(that) {\n  var r = [], curr = this\n  while (curr != that) {\n    r.push(curr.head())\n    curr = curr.tail()\n  }\n  return this.type() == String ? r.join('') : r\n}\n\nfunction OMInputStreamEnd(lst, idx) {\n  this.memo = { }\n  this.lst = lst\n  this.idx = idx\n}\nOMInputStreamEnd.prototype = objectThatDelegatesTo(OMInputStream.prototype)\nOMInputStreamEnd.prototype.head = function() { throw fail }\nOMInputStreamEnd.prototype.tail = function() { throw fail }\n\n// This is necessary b/c in IE, you can't say \"foo\"[idx]\nArray.prototype.at  = function(idx) { return this[idx] }\nString.prototype.at = String.prototype.charAt\n\nfunction ListOMInputStream(lst, idx) {\n  this.memo = { }\n  this.lst  = lst\n  this.idx  = idx\n  this.hd   = lst.at(idx)\n}\nListOMInputStream.prototype = objectThatDelegatesTo(OMInputStream.prototype)\nListOMInputStream.prototype.head = function() { return this.hd }\nListOMInputStream.prototype.tail = function() { return this.tl || (this.tl = makeListOMInputStream(this.lst, this.idx + 1)) }\n\nfunction makeListOMInputStream(lst, idx) { return new (idx < lst.length ? ListOMInputStream : OMInputStreamEnd)(lst, idx) }\n\nArray.prototype.toOMInputStream  = function() { return makeListOMInputStream(this, 0) }\nString.prototype.toOMInputStream = function() { return makeListOMInputStream(this, 0) }\n\nfunction makeOMInputStreamProxy(target) {\n  return objectThatDelegatesTo(target, {\n    memo:   { },\n    target: target,\n    tail:   function() { return makeOMInputStreamProxy(target.tail()) }\n  })\n}\n\n// Failer (i.e., that which makes things fail) is used to detect (direct) left recursion and memoize failures\n\nfunction Failer() { }\nFailer.prototype.used = false\n\n// the OMeta \"class\" and basic functionality\n\nOMeta = {\n  _apply: function(rule) {\n    var memoRec = this.input.memo[rule]\n    if (memoRec == undefined) {\n      var origInput = this.input,\n          failer    = new Failer()\n      if (this[rule] === undefined)\n        throw 'tried to apply undefined rule \"' + rule + '\"'\n      this.input.memo[rule] = failer\n      this.input.memo[rule] = memoRec = {ans: this[rule].call(this), nextInput: this.input}\n      if (failer.used) {\n        var sentinel = this.input\n        while (true) {\n          try {\n            this.input = origInput\n            var ans = this[rule].call(this)\n            if (this.input == sentinel)\n              throw fail\n            memoRec.ans       = ans\n            memoRec.nextInput = this.input\n          }\n          catch (f) {\n            if (f != fail)\n              throw f\n            break\n          }\n        }\n      }\n    }\n    else if (memoRec instanceof Failer) {\n      memoRec.used = true\n      throw fail\n    }\n    this.input = memoRec.nextInput\n    return memoRec.ans\n  },\n\n  // note: _applyWithArgs and _superApplyWithArgs are not memoized, so they can't be left-recursive\n  _applyWithArgs: function(rule) {\n    for (var idx = arguments.length - 1; idx > 0; idx--)\n      this._prependInput(arguments[idx])\n    return this[rule].call(this)\n  },\n  _superApplyWithArgs: function(recv, rule) {\n    for (var idx = arguments.length - 1; idx > 1; idx--)\n      recv._prependInput(arguments[idx])\n    return this[rule].call(recv)\n  },\n  _prependInput: function(v) {\n    this.input = new OMInputStream(v, this.input)\n  },\n\n  // if you want your grammar (and its subgrammars) to memoize parameterized rules, invoke this method on it:\n  memoizeParameterizedRules: function() {\n    this._prependInput = function(v) {\n      var newInput\n      if (isImmutable(v)) {\n        newInput = this.input[getTag(v)]\n        if (!newInput) {\n          newInput = new OMInputStream(v, this.input)\n          this.input[getTag(v)] = newInput\n        }\n      }\n      else newInput = new OMInputStream(v, this.input)\n      this.input = newInput\n    }\n    this._applyWithArgs = function(rule) {\n      for (var idx = arguments.length - 1; idx > 0; idx--)\n        this._prependInput(arguments[idx])\n      return this._apply(rule)\n    }\n  },\n\n  _pred: function(b) {\n    if (b)\n      return true\n    throw fail\n  },\n  _not: function(x) {\n    var origInput = this.input\n    try { x.call(this) }\n    catch (f) {\n      if (f != fail)\n        throw f\n      this.input = origInput\n      return true\n    }\n    throw fail\n  },\n  _lookahead: function(x) {\n    var origInput = this.input,\n        r         = x.call(this)\n    this.input = origInput\n    return r\n  },\n  _or: function() {\n    var origInput = this.input\n    for (var idx = 0; idx < arguments.length; idx++)\n      try { this.input = origInput; return arguments[idx].call(this) }\n      catch (f) {\n        if (f != fail)\n          throw f\n      }\n    throw fail\n  },\n  _xor: function(ruleName) {\n    var origInput = this.input, idx = 1, newInput, ans\n    while (idx < arguments.length) {\n      try {\n        this.input = origInput\n        ans = arguments[idx].call(this)\n        if (newInput)\n          throw 'more than one choice matched by \"exclusive-OR\" in ' + ruleName\n        newInput = this.input\n      }\n      catch (f) {\n        if (f != fail)\n          throw f\n      }\n      idx++\n    }\n    if (newInput) {\n      this.input = newInput\n      return ans\n    }\n    else\n      throw fail\n  },\n  disableXORs: function() {\n    this._xor = function(ruleName) {\n      var origInput = this.input\n      for (var idx = 1; idx < arguments.length; idx++)\n        try { this.input = origInput; return arguments[idx].call(this) }\n        catch (f) {\n          if (f != fail)\n            throw f\n        }\n      throw fail\n    }\n  },\n  _opt: function(x) {\n    var origInput = this.input, ans\n    try { ans = x.call(this) }\n    catch (f) {\n      if (f != fail)\n        throw f\n      this.input = origInput\n    }\n    return ans\n  },\n  _many: function(x) {\n    var ans = arguments[1] != undefined ? [arguments[1]] : []\n    while (true) {\n      var origInput = this.input\n      try { ans.push(x.call(this)) }\n      catch (f) {\n        if (f != fail)\n          throw f\n        this.input = origInput\n        break\n      }\n    }\n    return ans\n  },\n  _many1: function(x) { return this._many(x, x.call(this)) },\n  _form: function(x) {\n    var v = this._apply(\"anything\")\n    if (!isSequenceable(v))\n      throw fail\n    var origInput = this.input\n    this.input = v.toOMInputStream()\n    var r = x.call(this)\n    this._apply(\"end\")\n    this.input = origInput\n    return v\n  },\n  _consumedBy: function(x) {\n    var origInput = this.input\n    x.call(this)\n    return origInput.upTo(this.input)\n  },\n  _idxConsumedBy: function(x) {\n    var origInput = this.input\n    x.call(this)\n    return {fromIdx: origInput.idx, toIdx: this.input.idx}\n  },\n  _interleave: function(mode1, part1, mode2, part2 /* ..., moden, partn */) {\n    var currInput = this.input, ans = []\n    for (var idx = 0; idx < arguments.length; idx += 2)\n      ans[idx / 2] = (arguments[idx] == \"*\" || arguments[idx] == \"+\") ? [] : undefined\n    while (true) {\n      var idx = 0, allDone = true\n      while (idx < arguments.length) {\n        if (arguments[idx] != \"0\")\n          try {\n            this.input = currInput\n            switch (arguments[idx]) {\n              case \"*\": ans[idx / 2].push(arguments[idx + 1].call(this));                       break\n              case \"+\": ans[idx / 2].push(arguments[idx + 1].call(this)); arguments[idx] = \"*\"; break\n              case \"?\": ans[idx / 2] =    arguments[idx + 1].call(this);  arguments[idx] = \"0\"; break\n              case \"1\": ans[idx / 2] =    arguments[idx + 1].call(this);  arguments[idx] = \"0\"; break\n              default:  throw \"invalid mode '\" + arguments[idx] + \"' in OMeta._interleave\"\n            }\n            currInput = this.input\n            break\n          }\n          catch (f) {\n            if (f != fail)\n              throw f\n            // if this (failed) part's mode is \"1\" or \"+\", we're not done yet\n            allDone = allDone && (arguments[idx] == \"*\" || arguments[idx] == \"?\")\n          }\n        idx += 2\n      }\n      if (idx == arguments.length) {\n        if (allDone)\n          return ans\n        else\n          throw fail\n      }\n    }\n  },\n  _currIdx: function() { return this.input.idx },\n\n  // some basic rules\n  anything: function() {\n    var r = this.input.head()\n    this.input = this.input.tail()\n    return r\n  },\n  end: function() {\n    return this._not(function() { return this._apply(\"anything\") })\n  },\n  pos: function() {\n    return this.input.idx\n  },\n  empty: function() { return true },\n  apply: function() {\n    var r = this._apply(\"anything\")\n    return this._apply(r)\n  },\n  foreign: function() {\n    var g   = this._apply(\"anything\"),\n        r   = this._apply(\"anything\"),\n        gi  = objectThatDelegatesTo(g, {input: makeOMInputStreamProxy(this.input)})\n        gi.initialize();\n    var ans = gi._apply(r)\n    this.input = gi.input.target\n    return ans\n  },\n\n  //  some useful \"derived\" rules\n  exactly: function() {\n    var wanted = this._apply(\"anything\")\n    if (wanted === this._apply(\"anything\"))\n      return wanted\n    throw fail\n  },\n  \"true\": function() {\n    var r = this._apply(\"anything\")\n    this._pred(r === true)\n    return r\n  },\n  \"false\": function() {\n    var r = this._apply(\"anything\")\n    this._pred(r === false)\n    return r\n  },\n  \"undefined\": function() {\n    var r = this._apply(\"anything\")\n    this._pred(r === undefined)\n    return r\n  },\n  number: function() {\n    var r = this._apply(\"anything\")\n    this._pred(typeof r === \"number\")\n    return r\n  },\n  string: function() {\n    var r = this._apply(\"anything\")\n    this._pred(typeof r === \"string\")\n    return r\n  },\n  \"char\": function() {\n    var r = this._apply(\"anything\")\n    this._pred(typeof r === \"string\" && r.length == 1)\n    return r\n  },\n  space: function() {\n    var r = this._apply(\"char\")\n    this._pred(r.charCodeAt(0) <= 32)\n    return r\n  },\n  spaces: function() {\n    return this._many(function() { return this._apply(\"space\") })\n  },\n  digit: function() {\n    var r = this._apply(\"char\")\n    this._pred(r >= \"0\" && r <= \"9\")\n    return r\n  },\n  lower: function() {\n    var r = this._apply(\"char\")\n    this._pred(r >= \"a\" && r <= \"z\")\n    return r\n  },\n  upper: function() {\n    var r = this._apply(\"char\")\n    this._pred(r >= \"A\" && r <= \"Z\")\n    return r\n  },\n  letter: function() {\n    return this._or(function() { return this._apply(\"lower\") },\n                    function() { return this._apply(\"upper\") })\n  },\n  letterOrDigit: function() {\n    return this._or(function() { return this._apply(\"letter\") },\n                    function() { return this._apply(\"digit\")  })\n  },\n  firstAndRest: function()  {\n    var first = this._apply(\"anything\"),\n        rest  = this._apply(\"anything\")\n     return this._many(function() { return this._apply(rest) }, this._apply(first))\n  },\n  seq: function() {\n    var xs = this._apply(\"anything\")\n    for (var idx = 0; idx < xs.length; idx++)\n      this._applyWithArgs(\"exactly\", xs.at(idx))\n    return xs\n  },\n  notLast: function() {\n    var rule = this._apply(\"anything\"),\n        r    = this._apply(rule)\n    this._lookahead(function() { return this._apply(rule) })\n    return r\n  },\n\n  initialize: function() { },\n  // match and matchAll are a grammar's \"public interface\"\n  _genericMatch: function(input, rule, args, matchFailed) {\n    if (args == undefined)\n      args = []\n    var realArgs = [rule]\n    for (var idx = 0; idx < args.length; idx++)\n      realArgs.push(args[idx])\n    var m = objectThatDelegatesTo(this, {input: input})\n    m.initialize()\n    try { return realArgs.length == 1 ? m._apply.call(m, realArgs[0]) : m._applyWithArgs.apply(m, realArgs) }\n    catch (f) {\n      if (f == fail && matchFailed != undefined) {\n        var input = m.input\n        if (input.idx != undefined) {\n          while (input.tl != undefined && input.tl.idx != undefined)\n            input = input.tl\n          input.idx--\n        }\n        return matchFailed(m, input.idx)\n      }\n      throw f\n    }\n  },\n  match: function(obj, rule, args, matchFailed) {\n    return this._genericMatch([obj].toOMInputStream(),    rule, args, matchFailed)\n  },\n  matchAll: function(listyObj, rule, args, matchFailed) {\n    return this._genericMatch(listyObj.toOMInputStream(), rule, args, matchFailed)\n  },\n  createInstance: function() {\n    var m = objectThatDelegatesTo(this)\n    m.initialize()\n    m.matchAll = function(listyObj, aRule) {\n      m.input = listyObj.toOMInputStream()\n      return m._apply(aRule)\n    }\n    return m\n  }\n}\n\n"]}